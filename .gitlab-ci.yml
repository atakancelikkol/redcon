image: node:12.16.1

stages:
  - test

server:
  stage: test
  tags:
    - linux
  script:
    - cd ./server/
    - npm ci
    - npm run lint
    - npm run coverage

client:
  stage: test
  tags:
    - linux
  script:
    - cd ./client/
    - npm ci
    - npm run lint
    - npm run coverage

client:on-schedule:

  only:
    - schedules
  script:
    - cd ./client/
    - npm ci
    - npm audit

server:on-schedule:

  only:
    - schedules
  script:
    - cd ./server/
    - npm ci
    - npm audit